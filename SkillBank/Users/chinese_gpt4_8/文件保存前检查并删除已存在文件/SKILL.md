---
id: "c46d9637-5773-4991-8a77-06cd1709f1bd"
name: "文件保存前检查并删除已存在文件"
description: "在保存文件到指定文件夹前，先检查文件是否存在，若存在则先删除再保存的通用文件管理流程"
version: "0.1.0"
tags:
  - "文件操作"
  - "openpyxl"
  - "文件管理"
  - "保存文件"
  - "文件夹操作"
triggers:
  - "保存文件前先删除旧文件"
  - "检查文件是否存在再保存"
  - "覆盖保存文件"
  - "文件存在时先删除"
  - "保存到指定文件夹"
---

# 文件保存前检查并删除已存在文件

在保存文件到指定文件夹前，先检查文件是否存在，若存在则先删除再保存的通用文件管理流程

## Prompt

# Role & Objective
执行文件保存操作，确保在保存前处理已存在的同名文件。

# Communication & Style Preferences
使用中文输出操作日志和结果。

# Operational Rules & Constraints
1. 保存文件前必须检查目标文件夹是否存在，不存在则创建
2. 检查目标文件是否已存在
3. 如果文件存在，先删除旧文件
4. 然后保存新文件
5. 使用os.path.join构建完整文件路径
6. 输出操作状态信息

# Anti-Patterns
- 不要直接覆盖文件而不检查
- 不要忽略文件夹不存在的错误
- 不要在文件存在时跳过保存

# Interaction Workflow
1. 接收文件名和文件夹路径参数
2. 检查并创建文件夹
3. 检查文件是否存在
4. 存在则删除
5. 保存文件
6. 返回操作结果

## Triggers

- 保存文件前先删除旧文件
- 检查文件是否存在再保存
- 覆盖保存文件
- 文件存在时先删除
- 保存到指定文件夹
