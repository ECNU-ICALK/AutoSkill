---
id: "5e95d5c8-c230-419b-8531-b3d2931066dd"
name: "基于位置编码的灰度图像坐标映射网络实现"
description: "实现一个使用位置编码的神经网络，将灰度图像的像素坐标映射到像素值，支持任意尺寸输入输出，并包含训练、保存、加载和测试的完整流程。"
version: "0.1.0"
tags:
  - "位置编码"
  - "图像重建"
  - "神经网络"
  - "PyTorch"
  - "坐标映射"
triggers:
  - "写一个从灰度图像像素坐标映射到像素值的网络"
  - "使用position encoding实现任意尺寸图像生成"
  - "基于位置编码的图像重建网络"
  - "坐标到像素值的神经网络实现"
  - "保存和加载模型进行图像重建测试"
---

# 基于位置编码的灰度图像坐标映射网络实现

实现一个使用位置编码的神经网络，将灰度图像的像素坐标映射到像素值，支持任意尺寸输入输出，并包含训练、保存、加载和测试的完整流程。

## Prompt

# Role & Objective
实现一个从灰度图像像素坐标映射到像素值的神经网络，使用位置编码（positional encoding），使训练完成后能够输入任意尺寸并输出对应尺寸的图像。包含训练、模型保存、加载和测试的完整流程。

# Communication & Style Preferences
使用中文，代码注释清晰，变量命名有意义，输出信息简洁明了。

# Operational Rules & Constraints
1. 位置编码维度必须为偶数，默认64维。
2. 坐标网格生成后需归一化到[0,1]范围。
3. 模型结构为全连接网络：64->128->256->512->1，使用ReLU激活。
4. 训练使用MSELoss和Adam优化器，学习率0.001。
5. 所有张量和模型必须移动到同一设备（CPU或GPU）。
6. 保存模型使用state_dict，加载时需先实例化模型再加载参数。
7. 测试时模型设为eval模式，使用no_grad。
8. 图像显示时去除坐标轴和刻度，使用灰度色彩映射。

# Anti-Patterns
1. 不要忘记使用.to(device)的返回值。
2. 不要在训练时忘记model.train()，测试时忘记model.eval()。
3. 不要在保存图像时使用错误的文件名语法。
4. 不要让模型和数据在不同设备上运行。

# Interaction Workflow
1. 准备图像数据，生成坐标网格并归一化。
2. 生成位置编码并移动到设备。
3. 定义模型并移动到设备。
4. 训练模型，可选择保存模型。
5. 加载模型进行测试，生成任意尺寸图像并可视化。

## Triggers

- 写一个从灰度图像像素坐标映射到像素值的网络
- 使用position encoding实现任意尺寸图像生成
- 基于位置编码的图像重建网络
- 坐标到像素值的神经网络实现
- 保存和加载模型进行图像重建测试
